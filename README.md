## Simple ICM20948 Library (sorry, not working yet)
Very Simple ICM-20948 library (STM32 HAL)  
I'm still working on it...

~~~
uint8_t WHOAMI_AK09916()
{
	SELECT_USER_BANK(UserBank_0);
	ICM20948_WRITE(B0_USER_CTRL, I2C_MST_EN);

	SELECT_USER_BANK(UserBank_3);
	ICM20948_WRITE(B3_I2C_MST_CTRL, I2C_MST_CLK);

	SELECT_USER_BANK(UserBank_3);
	ICM20948_WRITE(B3_I2C_SLV0_ADDR, READ | ADDRESS_AK09916);	
	ICM20948_WRITE(B3_I2C_SLV0_REG, MAG_WIA2);
	ICM20948_WRITE(B3_I2C_SLV0_CTRL, I2C_SLV_EN | 1);
	HAL_Delay(10);

	SELECT_USER_BANK(UserBank_0);
	ICM20948_READ(B0_EXT_SLV_SENS_DATA_00, 1);

	return rx_buffer[0];	// 0x09
}
~~~
